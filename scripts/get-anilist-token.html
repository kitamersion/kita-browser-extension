<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get AniList Token</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 50px auto; padding: 20px; }
        .step { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .token { background: #f5f5f5; padding: 10px; border-radius: 3px; font-family: monospace; word-break: break-all; }
        button { padding: 10px 20px; background: #02a9ff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #0284c7; }
        input { width: 100%; padding: 8px; margin: 5px 0; }
    </style>
</head>
<body>
    <h1>Get AniList Access Token for Development</h1>
    
    <div class="step">
        <h3>Step 1: Enter your AniList App Details</h3>
        <p>If you don't have an app, create one at <a href="https://anilist.co/settings/developer" target="_blank">AniList Developer Settings</a></p>
        <input type="text" id="clientId" placeholder="Client ID">
        <button onclick="generateAuthUrl()">Generate Auth URL</button>
    </div>

    <div class="step" id="step2" style="display: none;">
        <h3>Step 2: Authorization URL</h3>
        <p>Click this URL to authorize your app and get your token:</p>
        <div class="token">
            <a href="#" id="authUrl" target="_blank">Click here to authorize</a>
        </div>
    </div>

    <div class="step">
        <h3>Step 3: Extract Token from URL</h3>
        <p>After authorization, you'll be redirected back with the token in the URL fragment (#).</p>
        <p>Paste the callback URL here to extract the token:</p>
        <input type="text" id="callbackUrl" placeholder="Paste the full callback URL here">
        <button onclick="extractToken()">Extract Token</button>
    </div>

    <div class="step" id="step4" style="display: none;">
        <h3>Step 4: Your Access Token</h3>
        <p>Add this to your .env file:</p>
        <div class="token" id="tokenResult">
            ANILIST_ACCESS_TOKEN=your_token_here
        </div>
        <button onclick="copyToken()">Copy to Clipboard</button>
    </div>

    <script>
        let extractedToken = '';

        function generateAuthUrl() {
            const clientId = document.getElementById('clientId').value;
            
            if (!clientId) {
                alert('Please fill in Client ID');
                return;
            }

            const authUrl = `https://anilist.co/api/v2/oauth/authorize?client_id=${clientId}&response_type=token`;
            
            document.getElementById('authUrl').href = authUrl;
            document.getElementById('authUrl').textContent = authUrl;
            document.getElementById('step2').style.display = 'block';
        }

        function extractToken() {
            const callbackUrl = document.getElementById('callbackUrl').value;
            
            if (!callbackUrl) {
                alert('Please paste the callback URL');
                return;
            }

            // Extract token from URL fragment
            const hashPart = callbackUrl.split('#')[1];
            if (!hashPart) {
                alert('No token found in URL. Make sure you pasted the complete callback URL.');
                return;
            }

            const params = new URLSearchParams(hashPart);
            const token = params.get('access_token');
            
            if (!token) {
                alert('No access_token found in the URL fragment.');
                return;
            }

            extractedToken = token;
            document.getElementById('tokenResult').textContent = `ANILIST_ACCESS_TOKEN=${token}`;
            document.getElementById('step4').style.display = 'block';
        }

        function copyToken() {
            if (!extractedToken) return;
            
            navigator.clipboard.writeText(`ANILIST_ACCESS_TOKEN=${extractedToken}`).then(() => {
                alert('Token copied to clipboard!');
            });
        }
    </script>
</body>
</html>
